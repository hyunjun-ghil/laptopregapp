<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>

<script src="https://code.jquery.com/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.devbridge-autocomplete/1.2.26/jquery.autocomplete.min.js"></script>

<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
<meta name="generator" content="Hugo 0.84.0">
<title>Signin Template · Bootstrap v5.0</title>

<link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/sign-in/">



<!-- Bootstrap core CSS -->
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/signin.css" rel="stylesheet">


<style>
.bd-placeholder-img {
	font-size: 1.125rem;
	text-anchor: middle;
	-webkit-user-select: none;
	-moz-user-select: none;
	user-select: none;
}

@media ( min-width : 768px) {
	.bd-placeholder-img-lg {
		font-size: 3.5rem;
	}
}
</style>
<!-- Custom styles for this template -->
</head>


<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Search Customer</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="frame">
					<div class="center">
						<input id="searchInput" placeholder="typing customer name">
					</div>
					<div id="customerSelected"></div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="modalSelectBtn">Select</button>
			</div>
		</div>
	</div>
</div>

<body class="text-center">

	<main class="form-signin">
		<form>
			<img class="mb-4" src="/image/kd.png" alt="" width="72" height="57">
			<h1 class="h3 mb-3 fw-normal">
				재택근무 노트북 </br> 등록 페이지
			</h1>

			<div class="form-floating">
				<input type="userid" class="form-control" id="floatingInput"> <label for="floatingInput">사용자 사번</label>
			</div>
			<div>
				<div style="display: inline-flex;">
					<label class="font-weight-bolder" style="width: 100px; padding-top: 10px;">고객명</label> <input type="text" class="form-control" id="search_custnm" name="search_custnm" style="width: 172px; margin: 2px;">
					<button type="button" class="btn btn-primary btn-xs" id="searchBtn" name="searchBtn" value="검색" style="align: right;" data-toggle="modal" data-target="#myModal">Search</button>
				</div>
			</div>
			<div>

				<div class="form-floating">
					<input type="userdept" class="form-control" id="floatingDept"> <label for="floatingDept">사용자 부서</label>
				</div>
				<div class="form-floating">
					<input type="usernm" class="form-control" id="floatingName"> <label for="floatingName">사용자 이름</label>
				</div>
				<div class="form-floating">
					<input type="serialnumber" class="form-control" id="floatingSerialNumber"> <label for="floatingSerialNumber">Password</label>
				</div>

				<button class="w-100 btn btn-lg btn-primary" type="submit">Sign in</button>
				<p class="mt-5 mb-3 text-muted">&copy; 2017–2021</p>
		</form>
	</main>



</body>

<script type="text/javascript">

	$("#search_orderno").change(function(){
		if($("#search_orderno").val() != ""){
			$("#search_custnm").val("");
			$("#search_custnm").attr("readonly", true);
			$("#search_custno").val("");
			$("#search_custno").attr("readonly", true);
		}else{
			$("#search_custnm").removeAttr("readonly");
			$("#search_custno").removeAttr("readonly");
		}
	});
	
	$("#search_custnm, #search_custno").change(function(){
		console.log($("#search_custnm").val());
		console.log($("#search_custno").val());
		console.log($("#search_orderno").val());
		
		if($("#search_custnm").val() != "" || $("#search_custno").val() != ""){
			$("#search_orderno").val("");
			$("#search_orderno").attr("readonly", true);
		}else{
			$("#search_orderno").removeAttr("readonly");
		}
	});
	
	
	$("#sBtn").on("click", function(e) { //KD/파트너
		if($("#search_custnm").val() == "" || $("#search_custnm").val() == null){
			$("#search_custnm").val("");	
		}
		if($("#search_custno").val() == "" || $("#search_custno").val() == null){
			$("#search_custno").val("");	
		}
		if($("#search_orderno").val() == "" || $("#search_orderno").val() == null){
			$("#search_orderno").val("");	
		}
		$('#sForm').submit();
	});
	
	$("#rBtn").on("click", function(e) { //KD/파트너
		$("#search_orderno").val("");
		$("#search_custnm").val("");
		$("#search_custno").val("");
		$("#search_orderno").removeAttr("readonly");
		$("#search_custnm").removeAttr("readonly");
		$("#search_custno").removeAttr("readonly");
	});

	$("#modalSelectBtn").on("click", function(e) {
		$("#search_custnm").val($("#modal_name").val());
		$("#search_custno").val($("#modal_id").val());
		$("#search_orderno").val("");
		$("#search_orderno").attr("readonly", true);
		$("#myModal").modal("hide");
	});

	var value = ${customer};

	$("#searchInput").autocomplete(
			{
				source : value,
				minLength : 2,// 최소 글자수
				//autoFocus : true, //첫번째 항목 자동 포커스 기본값 false
				classes : { //잘 모르겠음
					"ui-autocomplete" : "highlight"
				},
				position : {
					my : "right top",
					at : "right bottom"
				}, 
				select : function(event, ui) {
					var content = "Customer ID : " + ui.item.value + "</br>" + "Customer Name : " + ui.item.label; 
					$("#modal_id").val(ui.item.value);
					$("#modal_name").val(ui.item.label);
					$("#customerSelected").html(content)
				}
			});

	
	$("#myModal").on("shown.bs.modal", function() {
		$("#searchInput").autocomplete("option", "appendTo", "#myModal");
	})
	

</script>
<input type="hidden" id="modal_id" name="modal_id">
<input type="hidden" id="modal_name" name="modal_name">
</html>

